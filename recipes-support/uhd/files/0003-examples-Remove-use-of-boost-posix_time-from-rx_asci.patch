From 36be5216c237b15dbd00c17f33ac320192306882 Mon Sep 17 00:00:00 2001
From: Martin Braun <martin.braun@ettus.com>
Date: Wed, 9 May 2018 16:46:38 -0700
Subject: [PATCH] examples: Remove use of boost::posix_time from
 rx_ascii_art_dft

Upstream-Status: Backport [1]

[1] https://github.com/EttusResearch/uhd/commit/36be5216c237b15dbd00c17f33ac320192306882
---
 host/examples/rx_ascii_art_dft.cpp | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)

diff --git a/host/examples/rx_ascii_art_dft.cpp b/host/examples/rx_ascii_art_dft.cpp
index 26c84f52b..e242dbcd6 100644
--- a/host/examples/rx_ascii_art_dft.cpp
+++ b/host/examples/rx_ascii_art_dft.cpp
@@ -28,6 +28,7 @@
 #include <cstdlib>
 
 namespace po = boost::program_options;
+using std::chrono::high_resolution_clock;
 
 int UHD_SAFE_MAIN(int argc, char *argv[]){
     uhd::set_thread_priority_safe();
@@ -152,7 +153,7 @@ int UHD_SAFE_MAIN(int argc, char *argv[]){
     //------------------------------------------------------------------
     initscr(); //curses init
     rx_stream->issue_stream_cmd(uhd::stream_cmd_t::STREAM_MODE_START_CONTINUOUS);
-    boost::system_time next_refresh = boost::get_system_time();
+    auto next_refresh = high_resolution_clock::now();
 
     //------------------------------------------------------------------
     //-- Main loop
@@ -165,8 +166,12 @@ int UHD_SAFE_MAIN(int argc, char *argv[]){
         if (num_rx_samps != buff.size()) continue;
 
         //check and update the display refresh condition
-        if (boost::get_system_time() < next_refresh) continue;
-        next_refresh = boost::get_system_time() + boost::posix_time::microseconds(long(1e6/frame_rate));
+        if (high_resolution_clock::now() < next_refresh) {
+            continue;
+        }
+        next_refresh =
+            high_resolution_clock::now()
+            + std::chrono::microseconds(int64_t(1e6/frame_rate));
 
         //calculate the dft and create the ascii art frame
         ascii_art_dft::log_pwr_dft_type lpdft(
-- 
2.14.5

